# DeepLeabra（ディープリーブラ）

[![GoDoc](https://godoc.org/github.com/emer/leabra/deep?status.svg)](https://godoc.org/github.com/emer/leabra/deep)

パッケージdeepは、感覚皮質後部にある視床枕核（Pulvinar nucleus）の活性化状態を予測する試みによって予測学習を行うLeabraの**DeepLeabra**確率変数を提供します。
視床枕核の活動は100ミリ秒ごとに生じる，深層第5層の固有バースト（5IB）ニューロンによって駆動されています。5IBニューロンは極めて局所的（本質的に1対1）な，視床枕のThalamic Relay Cell（TRC）ニューロンへの結合を備えています。

このパッケージでは、レイヤータイプを`Deep`または`TRC` （例：Pulvinar）に指定することができます。
そして、各層のタイプと結びついた固有の計算が行われます。通常のリーブラのレイヤータイプは，すべて実質的に表層になっています。

ネットワーク図：

```
  Super Layer --BurstTRC--> Pulv
   |       ^                 ^
BurstCtxt  |        - Back -/
   |    [DeepAttn] /
   v      |       /
 Deep Layer -----   (typically only for higher->lower)

######################################################
[日本語版]
　　　表層 -------BurstTRC-----→ 視床枕
　　　 |　　　       ↑　　　　　　　↑
　　BurstCT    [深アテンション]   back
　　　 |　　　       |　　　       |
　　　 ↓　　　      ／　　　　　　／
　　  深層--------------------        (通常，より高次からより低次のみ)
```

ディープリーブラは、予測学習とアテンション調整の両方を扱っています。
深層と視床皮質回路の機能として以下のことが想定されています。

- 表層（Super layer）ニューロンは，新皮質の表層部を表現したものですが、バースト活性化信号を直接計算するためのベースでもあります。深層第５層の閾値処理を介して、深層5IBバースト活性化が反映されています（バースティングはより高い閾値を持つと考えられています）。

- `Burst`が更新されるときのアルファサイクルのクオーター
    ブロードキャストは`BurstParams.BurstQtr` において設定される（デフォルトはQ4で，ベータ周波数更新の場合はQ2およびQ4なども可能であり，`pbwm`で使用される）。このクオーターの間、表層からのバーストは，`BurstTRC`投射を介して`TRC`層（効率的な差分ベースの計算を使用）に継続的に送信され，これらの層におけるプラスフェーズの結果的な状態を作り出します。
    バーストクォーターの*終わり*に，`BurstCtxt`投射はバースト信号を`Deep`層のニューロンに伝達します。Deep層は，時間的に遅延したコンテクスト層の情報を表す値である`Ctxt`値に統合されます。注：深層も`Burst`値自体を計算します。これは、自己への投射を介して送信され，より広範な時間的文脈情報を提供してくれる広範な深層間（deep-to-deep）の水平結合を反映しています。

- `Deep`層のニューロンは、第6層の通常のspiking CT（corticothalamic: 皮質-視床）ニューロンを反映しています。そのニューロンは，視床に投射しており，マイクロカラム内の他のすべてのラミナ（lamina）に戻るようになっています。マイクロカラムでは乗数型の注意調整信号が生じています。これらのニューロンは、 `BurstCtxt`投射タイプを介して`Burst`活性値を受け取ります。通常は100ミリ秒ごとに1回、 `Ctxt`値に統合されます。この値は，他の興奮性コンダクタンス入力に加えられ，それらのニューロン全体の活性化（Act）を引き起こします。バースト入力の性質によって，深層ニューロンは，表層が*以前の*タイムステップでエンコードしたものを反映するようになります。－－したがって，深層は時間的に遅延した文脈状態を表現することになります。

- `Deep`ニューロンは、標準のAct-driven投射を介して`TRC` （視床枕）ニューロンに投影します。
    Act-driven投射は，TRCニューロンにおける標準的な`Ge`興奮性入力に統合され，予測学習の予測的側面を駆動します。また、活性値の注意による調整を行うために，`AttnGe` 、 `DeepAttn` ，`DeepLrn` ニューロンの変数で `DeepAttn`プロジェクションを介して，`Super`層のニューロンに投射し返すこともできます。

- `TRC`層のニューロンは、Super 層から`BurstTRC`投射を受け取ります（通常は
    `prjn.OneToOne`投射）。そして表層は，それらの視床枕層のプラスフェーズ*outcome*の活性化状態を駆動します（Super層は，実際には `5IB`のバースト活性値を計算しています）。これらの層は、深層からの定期的な接続も受け取っています。深層は，このプラスフェーズの結果状態の予測を駆動しており，その際に時間的に遅延した深層の文脈情報を利用しています。

- 注意の効果は、深層から表層への `DeepAttn`投射で以って実装されています。それらの投射は典型的にこていされたものであり，非学習な一対一対応の投射です。また，表層における，`AttnGe`の興奮性伝導を駆動するものとなっています。そしてそのとき，`AttnGe`は，`DeepAttn`と`DeepLrn`の値の計算を駆動し，その値が表層ニューロンの活性値（ `DeepAttn` ）や学習率（ `DeepLrn` ）を調整しています。

関係のある全パラメーターは、 `params.go`ファイル、Deep*Paramsの階層にあります。それらは， `deep.Layer`に含まれているフィールドです。

- `BurstParams` （レイヤーフィールド： `DeepBurst` ）には、バーストが更新されるタイミングであるBurstQtrと閾値パラメータがあります。

- `CtxtParams` （レイヤーフィールド： `DeepCtxt` ）には、DeepCtxt入力を統合するためのパラメーターがあります。

- `TRCParams` （レイヤーフィールド： `DeepTRC` ）には、TRCプラスフェーズの活性化状態を計算する方法についてのパラメーターがあります。なお，その活性化状態は，BurstTRC投射からのTRCBurstGe興奮性入力に基づいています。

- `AttnParams` （レイヤーフィールド： `DeepAttn` ）には、AttnGeからDeepAttnと
    のDeepLrnの計算に関するパラメータがあります。

ゲートありのワーキングメモリシステムをサポートするために，ディープフレームワーク上に構築されたモデル，すなわち前頭葉－大脳基底核ワーキングメモリ（Prefrontal-cortex Basal-ganglia Working Memory：PBWM）モデルについては、 [PBWMのREADME](https://github.com/emer/leabra/blob/master/pbwm/README.md)を参照してください。
